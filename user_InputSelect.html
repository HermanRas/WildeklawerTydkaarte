<!DOCTYPE html>
<html lang="en">

<head>
    <title>Wildeklawer Tydkaarte</title>

    <!-- Add Manifest -->
    <link rel="manifest" href="./manifest.json">
    <!-- End Manifest -->

    <!-- Chrome/android APP settings -->
    <meta name="theme-color" content="#00AB93">
    <link rel="icon" href="Img/icon.jpeg" sizes="192x192">
    <!-- end of Chrome/Android App Settings  -->

    <!-- Bootstrap // you can use hosted CDN here-->
    <link rel="stylesheet" href="CSS/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/app.css">
    <!-- end of bootstrap -->

    <!-- Import Custom Font -->
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
    <!-- end of Custom Font -->

    <!-- start dataTables.net -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">
    <!-- end of dataTables -->

    <!-- font-awesome 5.10.2 // not needed for theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css">
    <!-- end of font-awesome  -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Start of App JS -->
    <script src="App/dbAPI.js"></script>
    <script src="App/app.js"></script>
    <!-- End Of App JS -->
    <script src="JS/jquery-3.6.0.min.js"></script>
    <script src="./service-worker-install.js"></script>
    <script src="./service-worker.js"></script>
</head>

<body>
    <!-- NAV BAR -->
    <!-- FROM NAV.HTML -->
    <nav id="admin_menu" class="navbar navbar-expand-md navbar-dark  bg-dark p-1">

        <a class="btn btn-outline-secondary m-2 p-0 px-1" href="home.html">
            <img style="max-height:40px;" src="Img/tuis.png" class="rounded" alt="Tuis">
            <br>
            <span class="text-xxs">Tuis</span>
        </a>

        <a href="user_InputSelect.html" class="btn btn-outline-secondary m-2 p-0 px-1">
            <img style="max-height:40px;" src="Img/invoere.png" class="rounded" alt="Invoer">
            <br>
            <span class="text-xxs">Invoer</span>
        </a>
        <a href="user_InputCheckBins.php" class="btn btn-outline-secondary m-2 p-0 px-1">
            <img style="max-height:40px;" src="Img/bins.png" class="rounded" alt="Invoer">
            <br>
            <span class="text-xxs">Bins?</span>
        </a>
        <a href="user_InputBadge.html" class="btn btn-outline-secondary m-2 p-0 px-1">
            <img style="max-height:40px;" src="Img/klok.png" class="rounded" alt="Klok">
            <br>
            <span class="text-xxs">Klok</span>
        </a>
        <a href="#" onclick="logout()" class="btn btn-outline-secondary m-2 p-0 px-1">
            <img style="max-height:40px;" src="Img/teken_uit.png" class="rounded" alt="TekenUit">
            <br>
            <span class="text-xxs">TekenUit</span>
        </a>
    </nav>
    <!-- END NAV -->
    <!-- Page Title -->
    <!-- Main Content -->

    <!-- 
    #################################################################
    ## show camera and Code if found
    #################################################################
    -->
    <h1 class="bg-success"><img style="height:1.5em;" src="Img/invoere.png" class="rounded m-1 p-1" alt="Invoer">Invoer
    </h1>
    <div class="container">
        <script src="JS/sweetalert2.10.js"></script>
        <h3>Lees QR Kode</h3>
        <video style="max-width:300px; max-height:180px;display: block; margin: 0 auto;" id="qr-video"></video>
        <div id="cam-qr-result">Scanning ...</div>
    </div>

    <!-- Page Level Scripts -->
    <script type="module">
        //import plugins
        import QrScanner from "./JS/qr-scanner.min.js";
        QrScanner.WORKER_PATH = './JS/qr-scanner-worker.min.js';

        //set defaults
        const video = document.getElementById('qr-video');
        const camQrResult = document.getElementById('cam-qr-result');
        var lastResult = '';

        //run scan
        function setResult(label, result) {
            if (lastResult == result) {
                scanner.start();
            } else {
                lastResult = result;
                var cn = result.split(":");
                var contract_end = new Date(cn[2])
                var today = new Date();
                today.setHours(0, 0, 0, 0);
                if (contract_end < today) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'Die Kontrak het verval!'
                    })
                } else {
                    if (label) {
                        var cn = result.split(":");
                        label.innerHTML = '<h4> Werker: <hr>' + result +
                            ' gekies</h4><a href="user_InputData.html?User=' + cn[0] + '" class="btn btn-secondary">Stuur</a>';
                    }
                }
                scanner.start();
            }
        }

        // ####### Web Cam Scanning #######
        var scanner = new QrScanner(video, result => setResult(camQrResult, result));
        scanner.start();
        scanner.setInversionMode('original');
    </script>

    <!-- Footer -->
    <script>
        loadData('_footer.html', '', 'BODY');
    </script>
    <script scr="JS/bootstrap.bundle.min.js"></script>
</body>

</html>